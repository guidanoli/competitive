#!/usr/bin/env bash

source tests/framework

T 'cptk --version'
T 'cptk --help'

T 'rm -f etc/lang'

F 'cptk path'
F 'cptk run'
F 'cptk debug'
F 'cptk edit'
F 'cptk copy'
F 'cptk paste'
F 'cptk list'
F 'cptk load x'
F 'cptk save x'
F 'cptk remove x'

T 'cptk init c'
T 'rm -f "$(cptk path)"'
F 'cptk run'
F 'cptk debug'
F 'cptk copy'
F 'cptk save x'

F 'cptk ""'
F 'cptk .'
F 'cptk ..'
F 'cptk base'

F 'cptk init'
F 'cptk init ""'
F 'cptk init .'
F 'cptk init ..'
F 'cptk init lib'

T '! (cptk list | grep "^test$") || cptk remove test 2>/dev/null'

T 'echo test > etc/test'
T 'cp etc/test "$(cptk path)"'
T 'cptk copy'
T 'rm "$(cptk path)"'
T 'cptk paste'
T '[ -f "$(cptk path)" ]'
T 'diff etc/test "$(cptk path)"'
T 'cptk save test'
T 'cptk save test' # override 
T 'rm "$(cptk path)"'
T 'cptk open test'
T '[ -f "$(cptk path)" ]'
T 'diff etc/test "$(cptk path)"'
T 'cptk remove test'
F 'cptk remove test'
F 'cptk open test'
T 'rm etc/test'

T 'touch $(cptk path)'
F 'cptk save'
F 'cptk load'
F 'cptk remove'

F 'cptk save algo/assim'
F 'cptk save algo/'
F 'cptk save /'
F 'cptk save ""'
F 'cptk save .'
F 'cptk save ..'
T 'cptk save ...'
T 'cptk remove ...'

END
