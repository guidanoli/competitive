#!/usr/bin/env bash

# Exit on error
set -e

# Program variables
export programpath=$(readlink -f "${BASH_SOURCE[0]}")
export programname=$(basename "$programpath")
export programroot=$(dirname "$(dirname "$programpath")")

# Get command
if [[ $# -ge 1 ]]
then
	command=$1
	shift
else
	command=--help
fi

# Push root directory
pushd "$programroot" > /dev/null

# Get base directory
basedir=libexec/base

# If base command exists and is in the base directory
if libexec/is-child "$basedir" "$command" -type f
then
	# source the base command
	source "$basedir/$command"
else
	# else exit
	source libexec/err/unknown-command
fi
